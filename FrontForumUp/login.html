<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Login</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
<main class="center-content">
    <h1>Entrar</h1>

    <form onsubmit="enviarLogin(event)" style="display:flex; flex-direction:column; gap:10px;">
        <input type="email" id="emailLogin" placeholder="Email" required>
        <input type="password" id="senhaLogin" placeholder="Senha" required>
        <button type="submit" class="btn-login" style="background-color:#2563eb; color:white;">Entrar</button>
    </form>
</main>

<script>
    async function enviarLogin(event) {
        event.preventDefault(); // 1. Evita recarregamento

        const email = document.getElementById('emailLogin').value;
        const senha = document.getElementById('senhaLogin').value;

        // 2. Monta a URL com os dados pendurados
        // É assim que o @RequestParam do Java lê os dados
        const urlDestino = `http://localhost:8080/client/login?email=${email}&senha=${senha}`;

        try {
            // 3. Faz a chamada (sem 'body' e sem 'headers' de JSON)
            const resposta = await fetch(urlDestino, {
                method: 'POST'
            });

            // O Java retorna um texto simples ("Login bem-sucedido" ou erro)
            const textoResposta = await resposta.text();

            if (textoResposta.includes("bem-sucedido")) {
                alert(textoResposta);
                window.location.href = "dashboard.html"; // Entra no sistema!
            } else {
                alert("Ops: " + textoResposta);
            }
        } catch (erro) {
            console.error("Erro:", erro);
            alert("Erro ao conectar no servidor.");
        }
    }
</script>
</body>
</html>